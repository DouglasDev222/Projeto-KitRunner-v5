Implementa√ß√£o b√°sica de cupons de compra
Queremos implementar uma fun√ß√£o simples e funcional de cupons de desconto no fluxo de compra de eventos. O cupom poder√° oferecer desconto por valor fixo ou percentual e ser√° aplicado na tela de pagamento do evento.

üéØ Funcionalidade desejada
O cupom ser√° inserido na tela /events/:id/payment, logo abaixo do resumo do pedido.

O sistema dever√° validar e aplicar o cupom, recalculando o total.

Os cupons ser√£o gerenciados pelo painel do administrador, com op√ß√µes b√°sicas de cria√ß√£o e limite de uso.

üßæ Estrutura b√°sica da tabela de cupons
Sugest√£o de tabela: coupons

Campo	Tipo	Observa√ß√µes
id	integer (PK)	
code	string	C√≥digo do cupom (√∫nico e case-insensitive)
type	enum	"fixed" ou "percent"
value	decimal	Valor em R$ (para fixed) ou % (para percent)
description	string (opcional)	Texto explicativo
product_ids	array / JSON	IDs dos produtos eleg√≠veis (ou null para todos)
max_uses	integer (opcional)	Limite total de uso do cupom
uses	integer	Contador de usos j√° feitos
expires_at	datetime	Data de validade
active	boolean	Cupom ativo ou inativo
created_at	datetime	
updated_at	datetime	

üß© Fluxo no frontend /events/:id/payment
Campo de input para digitar o c√≥digo do cupom.

Bot√£o de "Aplicar" (ou autom√°tico ao sair do input).

Valida√ß√£o do cupom (chamada √† API):

Verifica se est√° ativo, n√£o expirado, se ainda tem uso dispon√≠vel, e se √© v√°lido para o produto atual.

Se v√°lido:

Mostrar o desconto aplicado e atualizar o total.

(Opcional simples) Feedback: ‚ÄúCupom aplicado com sucesso!‚Äù

Se inv√°lido:

Mostrar mensagem de erro: ‚ÄúCupom inv√°lido ou expirado.‚Äù

‚öôÔ∏è Backend ‚Äì Valida√ß√£o
Endpoint: POST /api/coupons/validate

Recebe code, product_id, event_id (se necess√°rio).

Retorna: tipo, valor, desconto aplicado, mensagem.

L√≥gica b√°sica:

code v√°lido (case-insensitive)

active == true

expires_at ainda v√°lida

max_uses n√£o excedido

product_ids compat√≠vel com o evento/kit comprado (ou null para todos)

üõ†Ô∏è Admin Panel
Nova se√ß√£o ‚ÄúCupons‚Äù no menu lateral do admin

Lista com os cupons existentes (filtros por ativo, expirado, etc.)

Bot√£o "Criar novo cupom"

Formul√°rio b√°sico com:

C√≥digo

Tipo (fixed ou percent)

Valor

Produtos aplic√°veis (checkbox ou select m√∫ltiplo)

Data de validade

Limite de uso

‚úÖ Checklist m√≠nimo para MVP
Banco de dados
 Criar tabela coupons

Backend
 Endpoint para aplicar cupom no checkout (POST /api/coupons/validate)

 Incrementar contador de uso ap√≥s pagamento confirmado (se desejar)

 Endpoint CRUD de cupons no admin

Frontend ‚Äì Cliente
 Campo de input de cupom na tela /events/:id/payment

 Aplicar desconto no resumo do pedido

 Mostrar mensagens de sucesso ou erro

Frontend ‚Äì Admin
 Listagem e cria√ß√£o de cupons


 Exibir a descri√ß√£o do cupom aplicado, se houver (ex: "Cupom 10OFF ‚Äì 10% de desconto"). (isso tem aparecer na tela de pedido do cliente que foi usado cupom e tamb√©m no detalhes do pedido do lado administrador)

 Bloquear m√∫ltiplos cupons (permitir apenas um por compra ‚Äì mais simples).